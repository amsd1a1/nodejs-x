#!/usr/bin/env bash


encoded_functions="Z2VuZXJhdGVfY29uZmlnKCkgewogIGVjaG8gIkdlbmVyYXRpbmcgY29uZmlnLmpzb24iCiAgICBpZiBbIC1mICIvYXBwL2Jsb2cvYy5qc29uIiBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCiAgY2F0ID4gL2FwcC9ibG9nL2MuanNvbiA8PCBFT0YKewogICJsb2ciOiB7CiAgICAiYWNjZXNzIjogIi9kZXYvbnVsbCIsCiAgICAiZXJyb3IiOiAiL2Rldi9udWxsIiwKICAgICJsb2dsZXZlbCI6ICJub25lIgogIH0sCiAgImluYm91bmRzIjogWwogICAgewogICAgICAicG9ydCI6IDE2MDAwLAogICAgICAicHJvdG9jb2wiOiAidmxlc3MiLAogICAgICAibGlzdGVuIjogIjEyNy4wLjAuMSIsCiAgICAgICJzZXR0aW5ncyI6IHsKICAgICAgICAiY2xpZW50cyI6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgImlkIjogImUwODRlMmQxLWVhN2ItNDAwMC04ZGUxLTM1MmM3MDcyNmRhMSIKICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgICJkZWNyeXB0aW9uIjogIm5vbmUiCiAgICAgIH0sCiAgICAgICJzdHJlYW1TZXR0aW5ncyI6IHsKICAgICAgICAibmV0d29yayI6ICJ3cyIsCiAgICAgICAgIndzU2V0dGluZ3MiOiB7CiAgICAgICAgICAicGF0aCI6ICIvbGVzcyIKICAgICAgICB9CiAgICAgIH0KICAgIH0KICBdLAogICJkbnMiOiB7CiAgICAic2VydmVycyI6IFsKICAgICAgewogICAgICAgICJhZGRyZXNzIjogInRjcCtsb2NhbDovLzguOC44LjgiCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAiYWRkcmVzcyI6ICJ0Y3ArbG9jYWw6Ly8xLjEuMS4xIgogICAgICB9LAogICAgICAibG9jYWxob3N0IgogICAgXQogIH0sCiAgIm91dGJvdW5kcyI6IFsKICAgIHsKICAgICAgInByb3RvY29sIjogImZyZWVkb20iCiAgICB9LAogICAgewogICAgICAidGFnIjogIldBUlAiLAogICAgICAicHJvdG9jb2wiOiAid2lyZWd1YXJkIiwKICAgICAgInNldHRpbmdzIjogewogICAgICAgICJzZWNyZXRLZXkiOiAiU1BkU3VNQ0oxQU9Na29tdmpmVDkxeGNqcHNKOXU3cHZXK3N0L1UrNVMyZz0iLAogICAgICAgICJhZGRyZXNzIjogWwogICAgICAgICAgIjE3Mi4xNi4wLjIvMzIiLAogICAgICAgICAgIjI2MDY6NDcwMDoxMTA6OGRiYjoxNGY6NjhlZTphYzVjOmViMWQvMTI4IgogICAgICAgIF0sCiAgICAgICAgInBlZXJzIjogWwogICAgICAgICAgewogICAgICAgICAgICAicHVibGljS2V5IjogImJtWE9DK0YxRnhFTUY5ZHlpSzJINS8xU1V0ekgwSnVWbzUxaDJ3UGZneW89IiwKICAgICAgICAgICAgImFsbG93ZWRJUHMiOiBbCiAgICAgICAgICAgICAgIjAuMC4wLjAvMCIsCiAgICAgICAgICAgICAgIjo6LzAiCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJlbmRwb2ludCI6ICIxNjIuMTU5LjE5NS4xMjc6MTAwMiIKICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgICJyZXNlcnZlZCI6IFsKICAgICAgICAgIDgzLAogICAgICAgICAgNTEsCiAgICAgICAgICAyNQogICAgICAgIF0sCiAgICAgICAgImtlcm5lbE1vZGUiOiBmYWxzZSwKICAgICAgICAibXR1IjogMTI4MAogICAgICB9CiAgICB9CiAgXSwKICAicm91dGluZyI6IHsKICAgICJkb21haW5TdHJhdGVneSI6ICJBc0lzIiwKICAgICJydWxlcyI6IFsKICAgICAgewogICAgICAgICJ0eXBlIjogImZpZWxkIiwKICAgICAgICAicG9ydCI6ICIwLTY1NTM1IiwKICAgICAgICAib3V0Ym91bmRUYWciOiAiV0FSUCIKICAgICAgfQogICAgXQogIH0KfQpFT0YKICAvYXBwL3NlcnYveHYgLWMgL2FwcC9ibG9nL2MuanNvbiA+IC9kZXYvbnVsbCAyPiYxICYKICAKICBzbGVlcCAxMAogIHJtIC1yZiAvYXBwL2Jsb2cvYy5qc29uCn0="


eval "$(echo "$encoded_functions" | base64 --decode)"

generate_config


nginx -g 'daemon off;'



